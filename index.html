<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
  <meta name="theme-color" content="#16213e">
  <title>Budgeting App</title>
  <link rel="manifest" href="/budgeting-pwa/manifest.json">
  <link rel="stylesheet" href="/budgeting-pwa/style.css">
  <link rel="apple-touch-icon" href="/budgeting-pwa/icons/icon-192.png">
</head>

<body>
  <div id="app">
    <!-- Dashboard View -->
    <main id="dashboard-view" class="view active">
      <header class="dashboard-header">
        <div class="budget-selector-container">
          <select id="budget-select" class="budget-select" aria-label="Select budget"></select>
          <button id="edit-budget-btn" class="btn-icon" aria-label="Rename budget">
            <svg viewBox="0 0 24 24" width="20" height="20">
              <path fill="currentColor"
                d="M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.39-.39-1.02-.39-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z" />
            </svg>
          </button>
          <button id="delete-budget-btn" class="btn-icon btn-icon-danger" aria-label="Delete budget">
            <svg viewBox="0 0 24 24" width="20" height="20">
              <path fill="currentColor"
                d="M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z" />
            </svg>
          </button>
        </div>
        <p id="month-label"></p>
      </header>

      <section class="budget-wheel-section">
        <svg id="budget-wheel" viewBox="0 0 200 200" aria-label="Budget visualization wheel"></svg>
        <div class="wheel-center">
          <span id="spent-amount">$0</span>
          <span id="budget-status">of $0</span>
        </div>
      </section>

      <p id="budget-utilization" class="budget-utilization">You are at 0% budget utilization</p>

      <section class="transactions-section">
        <div class="section-header">
          <h2>This Month</h2>
          <div class="header-actions">
            <button id="edit-target-btn" class="btn-icon" aria-label="Edit budget target">
              <svg viewBox="0 0 24 24" width="24" height="24">
                <path fill="currentColor"
                  d="M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.39-.39-1.02-.39-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z" />
              </svg>
            </button>
            <button id="clear-btn" class="btn-icon" aria-label="Clear data">
              <svg viewBox="0 0 24 24" width="24" height="24">
                <path fill="currentColor"
                  d="M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z" />
              </svg>
            </button>
            <button id="export-btn" class="btn-icon" aria-label="Export to CSV">
              <svg viewBox="0 0 24 24" width="24" height="24">
                <path fill="currentColor" d="M19 9h-4V3H9v6H5l7 7 7-7zM5 18v2h14v-2H5z" />
              </svg>
            </button>
          </div>
        </div>
        <ul id="transaction-list" class="transaction-list"></ul>
        <p id="empty-state" class="empty-state">No transactions yet. Tap + to add one.</p>
      </section>

      <button id="add-btn" class="fab" aria-label="Add transaction">
        <svg viewBox="0 0 24 24" width="28" height="28" fill="currentColor">
          <path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z" />
        </svg>
      </button>
    </main>

    <!-- Input View (Purchase Entry) -->
    <div id="input-view" class="view">
      <header class="input-header">
        <button id="back-btn" class="btn-icon" aria-label="Back">
          <svg viewBox="0 0 24 24" width="24" height="24">
            <path fill="currentColor" d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z" />
          </svg>
        </button>
        <h2>Add Purchase</h2>
        <button id="save-btn" class="btn-primary">Save</button>
      </header>

      <section class="amount-section">
        <div class="amount-display">
          <span class="currency">$</span>
          <span id="amount-value">0</span>
        </div>
        <button id="toggle-keyboard-btn" class="btn-text">Use Keyboard</button>
        <input type="number" id="keyboard-input" class="hidden" inputmode="decimal" step="0.01" min="0"
          placeholder="Enter amount">
      </section>

      <section id="wheel-picker-section" class="wheel-picker-section">
        <div class="wheel-column" data-digit="tens">
          <div class="wheel-items"></div>
        </div>
        <div class="wheel-column" data-digit="ones">
          <div class="wheel-items"></div>
        </div>
        <div class="wheel-highlight"></div>
      </section>

      <section class="category-section">
        <h3>Category</h3>
        <div class="category-grid">
          <button class="category-btn" data-category="Food">üçî Food</button>
          <button class="category-btn" data-category="Gas">‚õΩ Gas</button>
          <button class="category-btn" data-category="Utilities">üí° Utilities</button>
          <button class="category-btn" data-category="Misc">üì¶ Misc</button>
          <button class="category-btn" data-category="Medical">üè• Medical</button>
          <button class="category-btn" data-category="Drinks">üç∫ Drinks</button>
        </div>
      </section>

      <section class="notes-section">
        <h3>Description (optional)</h3>
        <textarea id="note-input" placeholder="Add a description..." maxlength="200" rows="2"></textarea>
      </section>
    </div>

    <!-- Settings Modal (for target) -->
    <dialog id="settings-modal">
      <form method="dialog">
        <h2>Monthly Budget Target</h2>
        <div class="form-group">
          <label for="target-input">Target Amount ($)</label>
          <input type="number" id="target-input" inputmode="decimal" step="1" min="0" value="1000">
        </div>
        <div class="modal-actions">
          <button type="button" id="cancel-settings-btn" class="btn-text">Cancel</button>
          <button type="submit" value="save" class="btn-primary">Save</button>
        </div>
      </form>
    </dialog>

    <!-- Export Modal -->
    <dialog id="export-modal">
      <form method="dialog">
        <h2>Export Data</h2>
        <div class="form-group">
          <label for="export-range">Date Range</label>
          <select id="export-range">
            <option value="current">Current Month</option>
            <option value="custom">Custom Range</option>
          </select>
        </div>
        <div id="export-date-range" class="form-group date-range-group hidden">
          <div class="date-inputs">
            <div>
              <label for="export-start-date">From</label>
              <input type="date" id="export-start-date">
            </div>
            <div>
              <label for="export-end-date">To</label>
              <input type="date" id="export-end-date">
            </div>
          </div>
        </div>
        <div class="modal-actions">
          <button type="button" id="cancel-export-btn" class="btn-text">Cancel</button>
          <button type="submit" id="confirm-export-btn" class="btn-primary">Export CSV</button>
        </div>
      </form>
    </dialog>

    <!-- Clear Data Modal -->
    <dialog id="clear-modal">
      <form method="dialog">
        <h2>Clear Data</h2>
        <p class="warning-text">‚ö†Ô∏è This action cannot be undone. All selected transactions will be permanently deleted.
        </p>
        <div class="form-group">
          <label for="clear-range">Date Range</label>
          <select id="clear-range">
            <option value="current">Current Month</option>
            <option value="custom">Custom Range</option>
          </select>
        </div>
        <div id="clear-date-range" class="form-group date-range-group hidden">
          <div class="date-inputs">
            <div>
              <label for="clear-start-date">From</label>
              <input type="date" id="clear-start-date">
            </div>
            <div>
              <label for="clear-end-date">To</label>
              <input type="date" id="clear-end-date">
            </div>
          </div>
        </div>
        <div class="modal-actions">
          <button type="button" id="cancel-clear-btn" class="btn-text">Cancel</button>
          <button type="submit" id="confirm-clear-btn" class="btn-danger">Delete Data</button>
        </div>
      </form>
    </dialog>

    <!-- Delete Transaction Confirmation Modal -->
    <dialog id="delete-tx-modal">
      <form method="dialog">
        <h2>Delete Transaction</h2>
        <p class="warning-text">‚ö†Ô∏è Are you sure you want to delete this transaction? This action cannot be undone.</p>
        <div class="modal-actions">
          <button type="button" id="cancel-delete-tx-btn" class="btn-text">Cancel</button>
          <button type="submit" id="confirm-delete-tx-btn" class="btn-danger">Delete</button>
        </div>
      </form>
    </dialog>
    <!-- Delete Budget Confirmation Modal -->
    <dialog id="delete-budget-modal">
      <form method="dialog">
        <h2>Delete Budget</h2>
        <p class="warning-text">‚ö†Ô∏è Are you sure you want to delete this budget? All transactions in this budget will be
          permanently deleted. This action cannot be undone.</p>
        <div class="modal-actions">
          <button type="button" id="cancel-delete-budget-btn" class="btn-text">Cancel</button>
          <button type="submit" id="confirm-delete-budget-btn" class="btn-danger">Delete Budget</button>
        </div>
      </form>
    </dialog>
  </div>

  <script src="/budgeting-pwa/lib/papaparse.min.js"></script>
  <script src="/budgeting-pwa/js/db.js"></script>
  <script src="/budgeting-pwa/js/csv-export.js"></script>
  <script src="/budgeting-pwa/js/app.js"></script>
</body>

</html>